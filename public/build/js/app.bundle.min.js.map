{"version":3,"sources":["app.bundle.min.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","_proceduralCity","window","onload","proceduralCity","./scenes/proceduralCity","2","Object","defineProperty","value","T","THREE","webglContainer","width","height","renderer","camera","scene","clock","firstPersonCtrls","generateBuilding","geometry","topColor","bottomColor","rndV","Math","round","random","clamp","faces","vertexColors","mesh","Mesh","position","x","floor","z","rotation","y","PI","scale","v","onWindowResize","event","offsetWidth","offsetHeight","setSize","aspect","updateProjectionMatrix","render","update","getDelta","requestAnimationFrame","document","getElementById","WebGLRenderer","alpha","antialias","appendChild","domElement","PerspectiveCamera","set","lookAt","Scene","fog","FogExp2","AxesHelper","light","HemisphereLight","add","FirstPersonControls","movementSpeed","lookSpeed","lookVertical","Clock","loader","CubeTextureLoader","textureCube","load","shader","ShaderLib","uniforms","skyMaterial","ShaderMaterial","fragmentShader","vertexShader","depthWrite","side","BackSide","needsUpdate","skyGeometry","BoxGeometry","skyBox","generateSkyBox","plane","PlaneGeometry","MeshBasicMaterial","color","cityGeometry","Geometry","applyMatrix","Matrix4","makeTranslation","splice","faceVertexUvs","Color","shadow","baseColor","setRGB","clone","multiply","mergeMesh","texture","Texture","canvas","createElement","context","getContext","fillStyle","fillRect","join","canvas2","imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","drawImage","generateTexture","anisotropy","capabilities","getMaxAnisotropy","cityMesh","VertexColors","map","generateCity","addEventListener","init"],"mappings":"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","file":"app.bundle.min.js","sourcesContent":["(function(){function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}return e})()({1:[function(require,module,exports){\n\"use strict\";\n\nvar _proceduralCity = require(\"./scenes/proceduralCity\");\n\nwindow.onload = _proceduralCity.proceduralCity; /*\n                                                 * ---------------------------------------------------------------------------------------\n                                                 * app.js\n                                                 * ---------------------------------------------------------------------------------------\n                                                 */\n\n},{\"./scenes/proceduralCity\":2}],2:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n/*\n * ---------------------------------------------------------------------------------------\n * proceduralCity\n * ---------------------------------------------------------------------------------------\n */\n\nvar proceduralCity = function proceduralCity() {\n    var T = THREE;\n\n    var webglContainer = void 0,\n        width = void 0,\n        height = void 0,\n        renderer = void 0,\n        camera = void 0,\n        scene = void 0,\n        clock = void 0,\n        firstPersonCtrls = void 0;\n\n    function init() {\n        webglContainer = document.getElementById(\"webglContainer\");\n        width = webglContainer.offsetWidth;\n        height = webglContainer.offsetHeight;\n\n        // init renderer\n        renderer = new T.WebGLRenderer({ alpha: true, antialias: true });\n        renderer.setSize(width, height);\n        webglContainer.appendChild(renderer.domElement);\n\n        // inti camera\n        camera = new T.PerspectiveCamera(45, width / height, 0.1, 4000);\n        camera.position.set(0, 150, 0);\n        camera.lookAt(0, 0, 0);\n\n        // init scene\n        scene = new T.Scene();\n        scene.fog = new T.FogExp2(0xd0e0f0, 0.0007);\n\n        // axes helper\n        var axesHelper = new T.AxesHelper(20);\n        // scene.add(axesHelper);\n\n        // light\n        var light = new T.HemisphereLight(0xfffff0, 0x101020, 1.25);\n        light.position.set(0.75, 1, 0.25);\n        scene.add(light);\n\n        // controls\n        firstPersonCtrls = new T.FirstPersonControls(camera);\n        firstPersonCtrls.movementSpeed = 80;\n        firstPersonCtrls.lookSpeed = 0.08;\n        firstPersonCtrls.lookVertical = true;\n\n        // clock\n        clock = new T.Clock();\n\n        generateSkyBox();\n        generateCity(8500);\n        window.addEventListener(\"resize\", onWindowResize, false);\n        render();\n    }\n\n    function generateCity(n) {\n\n        var plane = new T.Mesh(new T.PlaneGeometry(2000, 2000), new T.MeshBasicMaterial({ color: 0x101018 }));\n        plane.rotation.x = -90 * Math.PI / 180;\n        scene.add(plane);\n\n        var cityGeometry = new T.Geometry();\n\n        var geometry = new T.BoxGeometry(1, 1, 1);\n        // change pivot from center to bottom of the cube\n        geometry.applyMatrix(new T.Matrix4().makeTranslation(0, 0.5, 0));\n\n        // remove bottom side, because we will look from up to bottom\n        geometry.faces.splice(6, 2);\n        geometry.faceVertexUvs[0].splice(6, 2);\n\n        // uv mapping modified for top side\n        geometry.faceVertexUvs[0][4][0].set(0, 0);\n        geometry.faceVertexUvs[0][4][1].set(0, 0);\n        geometry.faceVertexUvs[0][4][2].set(0, 0);\n        geometry.faceVertexUvs[0][5][0].set(0, 0);\n        geometry.faceVertexUvs[0][5][1].set(0, 0);\n        geometry.faceVertexUvs[0][5][2].set(0, 0);\n\n        // building top/bottom colors\n        var light = new T.Color(0x1050ff);\n        var shadow = new T.Color(0x303050);\n        var value = 1 - Math.random() * Math.random();\n        var baseColor = new T.Color().setRGB(value + Math.random() * 0.1, value, value + Math.random() * 0.1);\n        var topColor = baseColor.clone().multiply(light);\n        var bottomColor = baseColor.clone().multiply(shadow);\n\n        for (var i = 0; i < n; i++) {\n            cityGeometry.mergeMesh(generateBuilding(geometry.clone(), topColor, bottomColor));\n        }\n\n        var texture = new T.Texture(generateTexture());\n        texture.anisotropy = renderer.capabilities.getMaxAnisotropy();\n        texture.needsUpdate = true;\n\n        var cityMesh = new T.Mesh(cityGeometry, new T.MeshBasicMaterial({ vertexColors: T.VertexColors, map: texture }));\n        scene.add(cityMesh);\n    }\n\n    function generateBuilding(geometry, topColor, bottomColor) {\n\n        var sign = Math.round(Math.random()) * 2 - 1;\n        var rndV = sign * Math.random() * Math.random() * Math.random() * Math.random() * 0.05;\n        topColor.r = clamp(topColor.r + rndV);\n        bottomColor.r = clamp(bottomColor.r + rndV * 0.1);\n\n        geometry.faces[0].vertexColors = geometry.faces[2].vertexColors = geometry.faces[6].vertexColors = geometry.faces[8].vertexColors = [topColor, bottomColor, topColor];\n\n        geometry.faces[1].vertexColors = geometry.faces[3].vertexColors = geometry.faces[7].vertexColors = geometry.faces[9].vertexColors = [bottomColor, bottomColor, topColor];\n\n        geometry.faces[4].vertexColors = geometry.faces[5].vertexColors = [topColor, topColor, topColor];\n\n        var mesh = new T.Mesh(geometry);\n\n        mesh.position.x = Math.floor(Math.random() * 200 - 100) * 10;\n        mesh.position.z = Math.floor(Math.random() * 200 - 100) * 10;\n        mesh.rotation.y = Math.random() * Math.PI * 2;\n        mesh.scale.x = Math.random() * Math.random() * Math.random() * Math.random() * 50 + 10;\n        mesh.scale.z = mesh.scale.x;\n        mesh.scale.y = Math.random() * Math.random() * Math.random() * mesh.scale.x * 8 + 8;\n\n        return mesh;\n    }\n\n    function clamp(v) {\n        if (v < 0) return 0;else if (v > 1) return 1;else return v;\n    }\n\n    function generateTexture() {\n\n        var canvas = document.createElement('canvas');\n        canvas.width = 32;\n        canvas.height = 64;\n\n        var context = canvas.getContext('2d');\n        context.fillStyle = '#ffffff';\n        context.fillRect(0, 0, 32, 64);\n\n        for (var y = 2; y < 64; y += 2) {\n            for (var x = 0; x < 32; x += 2) {\n                var value = Math.floor(Math.random() * 64);\n                context.fillStyle = 'rgb(' + [value, value, value].join(',') + ')';\n                context.fillRect(x, y, 2, 1);\n            }\n        }\n\n        var canvas2 = document.createElement('canvas');\n        canvas2.width = 512;\n        canvas2.height = 1024;\n\n        context = canvas2.getContext('2d');\n        context.imageSmoothingEnabled = false;\n        context.webkitImageSmoothingEnabled = false;\n        context.mozImageSmoothingEnabled = false;\n        context.drawImage(canvas, 0, 0, canvas2.width, canvas2.height);\n\n        return canvas2;\n    }\n\n    function generateSkyBox() {\n        var loader = new T.CubeTextureLoader();\n\n        var textures = ['app/assets/textures/nebula/left.jpg', 'app/assets/textures/nebula/right.jpg', 'app/assets/textures/nebula/top.jpg', 'app/assets/textures/nebula/bottom.jpg', 'app/assets/textures/nebula/front.jpg', 'app/assets/textures/nebula/back.jpg'];\n\n        var textureCube = loader.load(textures);\n        var shader = T.ShaderLib[\"cube\"];\n        shader.uniforms[\"tCube\"].value = textureCube;\n        var skyMaterial = new T.ShaderMaterial({\n            fragmentShader: shader.fragmentShader,\n            vertexShader: shader.vertexShader,\n            uniforms: shader.uniforms,\n            depthWrite: false,\n            side: T.BackSide\n        });\n        skyMaterial.needsUpdate = true;\n\n        var skyGeometry = new T.BoxGeometry(3000, 3000, 3000, 1, 1, 1);\n        var skyBox = new T.Mesh(skyGeometry, skyMaterial);\n        scene.add(skyBox);\n    }\n\n    function onWindowResize(event) {\n        width = webglContainer.offsetWidth;\n        height = webglContainer.offsetHeight;\n        renderer.setSize(width, height);\n        camera.aspect = width / height;\n        camera.updateProjectionMatrix();\n    }\n\n    function render() {\n\n        firstPersonCtrls.update(clock.getDelta());\n        renderer.render(scene, camera);\n        requestAnimationFrame(render);\n    }\n\n    // start scene\n    init();\n};\n\nexports.proceduralCity = proceduralCity;\n\n},{}]},{},[1]);\n"]}